(window.webpackJsonp=window.webpackJsonp||[]).push([[119],{ZmPN:function(e,t,n){"use strict";n.r(t),n.d(t,"CoreSitePreferencesPageModule",(function(){return V}));var i=n("fXoL"),r=n("tyNb"),c=n("L3Fv"),o=n("mrSG"),s=n("fjkH"),a=n("9+EE"),l=n("pHTc"),d=n("46ml"),g=n("EoRH"),_=n("baaQ"),h=n("1gmh"),f=n("3LXp"),u=n("GGba"),m=n("j3ag"),P=n("CvRw"),p=n("YEzr");class settings_handlers_source_CoreSettingsHandlersSource extends P.a{constructor(){super(...arguments),this.handlers=[]}loadPageItems(){return Object(o.a)(this,void 0,void 0,(function*(){return this.handlers=p.a.getHandlers(),{items:this.handlers.filter((e=>"page"in e))}}))}getItemPath(e){return e.page}getItemQueryParams(e){return e.params||{}}}var C=n("TEn/"),S=n("nt/U"),b=n("PgjG"),y=n("ofXK"),D=n("3CSS"),v=n("3zv0"),O=n("ACYt"),w=n("3Pt+"),E=n("sYmb");function CoreSitePreferencesPage_ion_item_17_ion_icon_2_Template(e,t){if(1&e&&i.zc(0,"ion-icon",18),2&e){const e=i.Oc().$implicit;i.Vc("name",e.icon)}}function CoreSitePreferencesPage_ion_item_17_ion_toggle_7_Template(e,t){if(1&e){const e=i.Fc();i.Ec(0,"ion-toggle",19),i.Mc("ngModelChange",(function CoreSitePreferencesPage_ion_item_17_ion_toggle_7_Template_ion_toggle_ngModelChange_0_listener(t){i.fd(e);return i.Oc().$implicit.toggleChecked=t}))("ionChange",(function CoreSitePreferencesPage_ion_item_17_ion_toggle_7_Template_ion_toggle_ionChange_0_listener(t){i.fd(e);return i.Oc().$implicit.toggle(t.detail.checked)})),i.Dc()}if(2&e){const e=i.Oc().$implicit;i.Vc("ngModel",e.toggleChecked)}}function CoreSitePreferencesPage_ion_item_17_Template(e,t){if(1&e){const e=i.Fc();i.Ec(0,"ion-item",15),i.Mc("click",(function CoreSitePreferencesPage_ion_item_17_Template_ion_item_click_0_listener(){i.fd(e);const n=t.$implicit,r=i.Oc();return!n.toggle&&r.handlers.select(n)})),i.Pc(1,"translate"),i.nd(2,CoreSitePreferencesPage_ion_item_17_ion_icon_2_Template,1,1,"ion-icon",16),i.Ec(3,"ion-label"),i.Ec(4,"p",9),i.pd(5),i.Pc(6,"translate"),i.Dc(),i.Dc(),i.nd(7,CoreSitePreferencesPage_ion_item_17_ion_toggle_7_Template,1,1,"ion-toggle",17),i.Dc()}if(2&e){const e=t.$implicit,n=i.Oc();i.Vc("ngClass",e.class)("button",!e.toggle)("detail",!e.toggle),i.mc("aria-label",i.Qc(1,8,e.title))("aria-current",n.handlers.getItemAriaCurrent(e)),i.lc(2),i.Vc("ngIf",e.icon),i.lc(3),i.qd(i.Qc(6,10,e.title)),i.lc(2),i.Vc("ngIf",e.toggle)}}function CoreSitePreferencesPage_ion_item_37_ng_container_3_Template(e,t){1&e&&(i.Cc(0),i.pd(1),i.Pc(2,"translate"),i.Bc()),2&e&&(i.lc(1),i.rd(" ",i.Qc(2,1,"core.settings.connectwifitosync"),""))}function CoreSitePreferencesPage_ion_item_37_ng_container_4_Template(e,t){1&e&&(i.Cc(0),i.pd(1),i.Pc(2,"translate"),i.Bc()),2&e&&(i.lc(1),i.qd(i.Qc(2,1,"core.settings.connecttosync")))}function CoreSitePreferencesPage_ion_item_37_Template(e,t){if(1&e&&(i.Ec(0,"ion-item",20),i.zc(1,"ion-icon",21),i.Ec(2,"ion-label"),i.nd(3,CoreSitePreferencesPage_ion_item_37_ng_container_3_Template,3,3,"ng-container",22),i.nd(4,CoreSitePreferencesPage_ion_item_37_ng_container_4_Template,3,3,"ng-container",22),i.Dc(),i.Dc()),2&e){const e=i.Oc();i.lc(3),i.Vc("ngIf",e.isOnline&&e.dataSaver&&e.limitedConnection),i.lc(1),i.Vc("ngIf",!e.isOnline)}}let T=(()=>{class CoreSitePreferencesPage{constructor(){this.dataSaver=!1,this.limitedConnection=!1,this.isOnline=!0,this.isDestroyed=!1,this.siteId=a.b.getCurrentSiteId();const e=_.a.getOrCreateSource(settings_handlers_source_CoreSettingsHandlersSource,[]);this.handlers=new g.a(e,CoreSitePreferencesPage),console.log("pref handlers",this.handlers),this.sitesObserver=s.b.on(s.b.SITE_UPDATED,(()=>{this.refreshData()}),this.siteId),this.isOnline=u.a.isOnline(),this.limitedConnection=this.isOnline&&u.a.isNetworkAccessLimited(),this.networkObserver=u.a.onChange().subscribe((()=>{m.z.run((()=>{this.isOnline=u.a.isOnline(),this.limitedConnection=this.isOnline&&u.a.isNetworkAccessLimited()}))}))}get handlerItems(){return this.handlers.getSource().handlers}goToGenSettings(){l.a.navigateToSitePath("/settings/general")}ngAfterViewInit(){return Object(o.a)(this,void 0,void 0,(function*(){this.dataSaver=!1;const e=l.a.getRouteParam("page");try{yield this.fetchData()}finally{const t=e?this.handlers.items.find((t=>t.page==e)):void 0;t?(this.handlers.watchSplitViewOutlet(this.splitView),yield this.handlers.select(t)):yield this.handlers.start(this.splitView)}}))}fetchData(){return Object(o.a)(this,void 0,void 0,(function*(){yield this.handlers.load()}))}synchronize(){return Object(o.a)(this,void 0,void 0,(function*(){try{yield h.a.synchronizeSite(!1,this.siteId)}catch(e){if(this.isDestroyed)return;f.a.showErrorModalDefault(e,"core.settings.sitesyncfailed",!0)}}))}isSynchronizing(){return!!h.a.getSiteSyncPromise(this.siteId)}refreshData(e){this.handlers.getSource().setDirty(!0),this.fetchData().finally((()=>{null==e?void 0:e.complete()}))}ngOnDestroy(){this.isDestroyed=!0,this.sitesObserver.off(),this.networkObserver.unsubscribe(),this.handlers.destroy()}}return CoreSitePreferencesPage.ɵfac=function CoreSitePreferencesPage_Factory(e){return new(e||CoreSitePreferencesPage)},CoreSitePreferencesPage.ɵcmp=i.sc({type:CoreSitePreferencesPage,selectors:[["page-core-site-preferences"]],viewQuery:function CoreSitePreferencesPage_Query(e,t){var n;(1&e&&i.ud(d.a,!0),2&e)&&(i.dd(n=i.Nc())&&(t.splitView=n.first))},decls:38,vars:30,consts:[["slot","start"],[3,"text"],["slot","end"],["slot","fixed",3,"disabled","ionRefresh"],[3,"pullingText"],[3,"hideUntil"],["class","core-settings-handler",3,"ngClass","button","detail","click",4,"ngFor","ngForOf"],[1,"core-settings-handler",3,"detail","button","click"],["slot","start",3,"name"],[1,"item-heading"],[1,"ion-text-wrap"],["slot","end",3,"loading"],["fill","clear",3,"disabled","click"],["name","fas-sync-alt","slot","icon-only","aria-hidden","true"],["class","core-warning-item ion-text-wrap",4,"ngIf"],[1,"core-settings-handler",3,"ngClass","button","detail","click"],["slot","start","aria-hidden","true",3,"name",4,"ngIf"],[3,"ngModel","ngModelChange","ionChange",4,"ngIf"],["slot","start","aria-hidden","true",3,"name"],[3,"ngModel","ngModelChange","ionChange"],[1,"core-warning-item","ion-text-wrap"],["name","fas-exclamation-triangle","slot","start","aria-hidden","true"],[4,"ngIf"]],template:function CoreSitePreferencesPage_Template(e,t){1&e&&(i.Ec(0,"ion-header"),i.Ec(1,"ion-toolbar"),i.Ec(2,"ion-buttons",0),i.zc(3,"ion-back-button",1),i.Pc(4,"translate"),i.Dc(),i.Ec(5,"ion-title"),i.Ec(6,"h1"),i.pd(7),i.Pc(8,"translate"),i.Dc(),i.Dc(),i.zc(9,"ion-buttons",2),i.Dc(),i.Dc(),i.Ec(10,"ion-content"),i.Ec(11,"core-split-view"),i.Ec(12,"ion-refresher",3),i.Mc("ionRefresh",(function CoreSitePreferencesPage_Template_ion_refresher_ionRefresh_12_listener(e){return t.refreshData(e.target)})),i.zc(13,"ion-refresher-content",4),i.Pc(14,"translate"),i.Dc(),i.Ec(15,"core-loading",5),i.Ec(16,"ion-list"),i.nd(17,CoreSitePreferencesPage_ion_item_17_Template,8,12,"ion-item",6),i.Ec(18,"ion-item",7),i.Mc("click",(function CoreSitePreferencesPage_Template_ion_item_click_18_listener(){return t.goToGenSettings()})),i.zc(19,"ion-icon",8),i.Ec(20,"ion-label"),i.Ec(21,"p",9),i.pd(22),i.Pc(23,"translate"),i.Dc(),i.Dc(),i.Dc(),i.Dc(),i.Ec(24,"ion-card"),i.Ec(25,"ion-item",10),i.Ec(26,"ion-label"),i.Ec(27,"p",9),i.pd(28),i.Pc(29,"translate"),i.Dc(),i.Ec(30,"p"),i.pd(31),i.Pc(32,"translate"),i.Dc(),i.Dc(),i.Ec(33,"core-button-with-spinner",11),i.Ec(34,"ion-button",12),i.Mc("click",(function CoreSitePreferencesPage_Template_ion_button_click_34_listener(){return t.synchronize()})),i.Pc(35,"translate"),i.zc(36,"ion-icon",13),i.Dc(),i.Dc(),i.Dc(),i.nd(37,CoreSitePreferencesPage_ion_item_37_Template,5,2,"ion-item",14),i.Dc(),i.Dc(),i.Dc(),i.Dc()),2&e&&(i.lc(3),i.Vc("text",i.Qc(4,16,"core.back")),i.lc(4),i.qd(i.Qc(8,18,"core.settings.preferences")),i.lc(5),i.Vc("disabled",!t.handlers.loaded),i.lc(1),i.Wc("pullingText",i.Qc(14,20,"core.pulltorefresh")),i.lc(2),i.Vc("hideUntil",t.handlers.loaded),i.lc(2),i.Vc("ngForOf",t.handlerItems),i.lc(1),i.Vc("detail",!0)("button",!0),i.lc(1),i.Vc("name","settings"),i.lc(3),i.qd(i.Qc(23,22,"core.settings.general")),i.lc(6),i.qd(i.Qc(29,24,"core.settings.synchronizenow")),i.lc(3),i.rd(" ",i.Qc(32,26,"core.settings.synchronizenowhelp")," "),i.lc(2),i.Vc("loading",t.isSynchronizing()),i.lc(1),i.Vc("disabled",!t.isOnline||t.dataSaver&&t.limitedConnection),i.mc("aria-label",i.Qc(35,28,"core.settings.synchronizenow")),i.lc(3),i.Vc("ngIf",!t.isOnline||t.dataSaver&&t.limitedConnection))},directives:[C.C,C.Ab,C.m,C.h,C.i,C.yb,S.a,C.v,d.a,C.bb,C.cb,b.a,C.P,y.s,C.I,C.D,D.a,C.O,C.n,v.a,O.a,C.l,y.t,y.q,C.zb,C.d,w.r,w.u],pipes:[E.d],encapsulation:2}),CoreSitePreferencesPage})();var M=n("vY5A"),k=n("X9cG"),I=n("Y+03");function buildRoutes(e){const t=Object(M.d)(e,k.b),n=[{path:"",component:T},...t.siblings],i=[{path:"",component:T,children:t.siblings}];return[...Object(M.c)(n,(()=>I.a.isMobile)),...Object(M.c)(i,(()=>I.a.isTablet))]}let V=(()=>{class CoreSitePreferencesPageModule{}return CoreSitePreferencesPageModule.ɵmod=i.wc({type:CoreSitePreferencesPageModule}),CoreSitePreferencesPageModule.ɵinj=i.vc({factory:function CoreSitePreferencesPageModule_Factory(e){return new(e||CoreSitePreferencesPageModule)},providers:[{provide:r.g,multi:!0,useFactory:buildRoutes,deps:[i.x]}],imports:[[c.a],r.m]}),CoreSitePreferencesPageModule})();void(("undefined"==typeof ngJitMode||ngJitMode)&&i.kd(V,{declarations:[T],imports:[c.a],exports:[r.m]}))}}]);