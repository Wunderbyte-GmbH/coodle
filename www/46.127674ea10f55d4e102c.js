(window.webpackJsonp=window.webpackJsonp||[]).push([[46],{FguK:function(e,t,i){"use strict";i.r(t),i.d(t,"AddonMessageOutputAirnotifierDevicesPageModule",(function(){return M}));var n=i("tyNb"),o=i("L3Fv"),c=i("mrSG"),r=i("3LXp"),s=i("Afn4"),a=i("FEUt"),d=i("bFG1"),l=i("fXoL"),u=i("TEn/"),p=i("nt/U"),g=i("PgjG"),f=i("ofXK"),m=i("3zv0"),v=i("3Pt+"),D=i("sYmb"),_=i("uYHD");function AddonMessageOutputAirnotifierDevicesPage_ng_container_14_ion_item_7_p_6_Template(e,t){1&e&&(l.Ec(0,"p"),l.Ec(1,"strong"),l.pd(2),l.Pc(3,"translate"),l.Dc(),l.Dc()),2&e&&(l.lc(2),l.qd(l.Qc(3,1,"core.currentdevice")))}function AddonMessageOutputAirnotifierDevicesPage_ng_container_14_ion_item_7_Template(e,t){if(1&e){const e=l.Fc();l.Ec(0,"ion-item",6),l.Ec(1,"ion-label"),l.Ec(2,"p",8),l.Ec(3,"strong"),l.pd(4),l.Dc(),l.pd(5),l.Dc(),l.nd(6,AddonMessageOutputAirnotifierDevicesPage_ng_container_14_ion_item_7_p_6_Template,4,3,"p",9),l.Ec(7,"p"),l.pd(8),l.Pc(9,"translate"),l.Pc(10,"coreFormatDate"),l.Dc(),l.Dc(),l.Ec(11,"core-button-with-spinner",10),l.Ec(12,"ion-toggle",11),l.Mc("ngModelChange",(function AddonMessageOutputAirnotifierDevicesPage_ng_container_14_ion_item_7_Template_ion_toggle_ngModelChange_12_listener(i){l.fd(e);return t.$implicit.enable=i}))("ngModelChange",(function AddonMessageOutputAirnotifierDevicesPage_ng_container_14_ion_item_7_Template_ion_toggle_ngModelChange_12_listener(){l.fd(e);const i=t.$implicit;return l.Oc(2).enableDevice(i,i.enable)})),l.Dc(),l.Dc(),l.Dc()}if(2&e){const e=t.$implicit,i=l.Oc().$implicit;l.qc("item-current",e.current),l.lc(4),l.sd("",e.name," ",e.model,""),l.lc(1),l.sd(" (",i.platform," ",e.version,") "),l.lc(1),l.Vc("ngIf",e.current),l.lc(2),l.sd(" ",l.Qc(9,11,"core.lastmodified"),": ",l.Rc(10,13,1e3*e.timemodified,"strftimedatetimeshort")," "),l.lc(3),l.Vc("loading",e.updating),l.lc(1),l.Vc("ngModel",e.enable)}}function AddonMessageOutputAirnotifierDevicesPage_ng_container_14_Template(e,t){if(1&e&&(l.Cc(0),l.Ec(1,"ion-item-divider",6),l.Ec(2,"ion-label"),l.Ec(3,"h2"),l.pd(4),l.Dc(),l.Dc(),l.Dc(),l.Ec(5,"ion-card"),l.Ec(6,"ion-list"),l.nd(7,AddonMessageOutputAirnotifierDevicesPage_ng_container_14_ion_item_7_Template,13,16,"ion-item",7),l.Dc(),l.Dc(),l.Bc()),2&e){const e=t.$implicit;l.lc(4),l.qd(e.platform),l.lc(3),l.Vc("ngForOf",e.devices)}}let h=(()=>{class AddonMessageOutputAirnotifierDevicesPage{constructor(){this.platformDevices=[],this.loaded=!1}ngOnInit(){this.fetchDevices()}fetchDevices(){return Object(c.a)(this,void 0,void 0,(function*(){try{const e=yield a.a.getUserDevices();this.formatDevices(e)}catch(e){r.a.showErrorModal(e)}finally{this.loaded=!0}}))}formatDevices(e){this.platformDevices=[];const t={},i=s.a.getPushId();e.forEach((e=>{void 0===t[e.platform]&&(t[e.platform]={platform:e.platform,devices:[]}),e.enable=!!e.enable,e.current=i===e.pushid,t[e.platform].devices.push(e)}));for(const e in t){const i=t[e];i.devices.sort(((e,t)=>t.timemodified-e.timemodified)),i.platform=i.platform.replace("-fcm",""),this.platformDevices.push(i)}}updateDevicesAfterDelay(){this.updateTimeout&&clearTimeout(this.updateTimeout),this.updateTimeout=window.setTimeout((()=>{this.updateTimeout=void 0,this.updateDevices()}),5e3)}updateDevices(){return Object(c.a)(this,void 0,void 0,(function*(){yield d.a.ignoreErrors(a.a.invalidateUserDevices()),yield a.a.getUserDevices()}))}refreshDevices(e){return Object(c.a)(this,void 0,void 0,(function*(){try{yield d.a.ignoreErrors(a.a.invalidateUserDevices()),yield this.fetchDevices()}finally{null==e?void 0:e.complete()}}))}enableDevice(e,t){return Object(c.a)(this,void 0,void 0,(function*(){e.updating=!0;try{yield a.a.enableDevice(e.id,t),this.updateDevicesAfterDelay()}catch(t){r.a.showErrorModal(t),e.enable=!e.enable}finally{e.updating=!1}}))}ngOnDestroy(){this.updateTimeout&&(clearTimeout(this.updateTimeout),this.updateDevices())}}return AddonMessageOutputAirnotifierDevicesPage.ɵfac=function AddonMessageOutputAirnotifierDevicesPage_Factory(e){return new(e||AddonMessageOutputAirnotifierDevicesPage)},AddonMessageOutputAirnotifierDevicesPage.ɵcmp=l.sc({type:AddonMessageOutputAirnotifierDevicesPage,selectors:[["page-addon-message-output-airnotifier-devices"]],decls:15,vars:12,consts:[["slot","start"],[3,"text"],["slot","fixed",3,"disabled","ionRefresh"],[3,"pullingText"],[3,"hideUntil"],[4,"ngFor","ngForOf"],[1,"ion-text-wrap"],["class","ion-text-wrap",3,"item-current",4,"ngFor","ngForOf"],[1,"item-heading"],[4,"ngIf"],["slot","end",3,"loading"],[3,"ngModel","ngModelChange"]],template:function AddonMessageOutputAirnotifierDevicesPage_Template(e,t){1&e&&(l.Ec(0,"ion-header"),l.Ec(1,"ion-toolbar"),l.Ec(2,"ion-buttons",0),l.zc(3,"ion-back-button",1),l.Pc(4,"translate"),l.Dc(),l.Ec(5,"ion-title"),l.Ec(6,"h1"),l.pd(7),l.Pc(8,"translate"),l.Dc(),l.Dc(),l.Dc(),l.Dc(),l.Ec(9,"ion-content"),l.Ec(10,"ion-refresher",2),l.Mc("ionRefresh",(function AddonMessageOutputAirnotifierDevicesPage_Template_ion_refresher_ionRefresh_10_listener(e){return t.refreshDevices(e.target)})),l.zc(11,"ion-refresher-content",3),l.Pc(12,"translate"),l.Dc(),l.Ec(13,"core-loading",4),l.nd(14,AddonMessageOutputAirnotifierDevicesPage_ng_container_14_Template,8,2,"ng-container",5),l.Dc(),l.Dc()),2&e&&(l.lc(3),l.Vc("text",l.Qc(4,6,"core.back")),l.lc(4),l.qd(l.Qc(8,8,"addon.messageoutput_airnotifier.processorsettingsdesc")),l.lc(3),l.Vc("disabled",!t.loaded),l.lc(1),l.Wc("pullingText",l.Qc(12,10,"core.pulltorefresh")),l.lc(2),l.Vc("hideUntil",t.loaded),l.lc(1),l.Vc("ngForOf",t.platformDevices))},directives:[u.C,u.Ab,u.m,u.h,u.i,u.yb,p.a,u.v,u.bb,u.cb,g.a,f.s,u.J,u.O,u.n,u.P,u.I,f.t,m.a,u.zb,u.d,v.r,v.u],pipes:[D.d,_.a],encapsulation:2}),AddonMessageOutputAirnotifierDevicesPage})();const A=[{path:"",component:h}];let M=(()=>{class AddonMessageOutputAirnotifierDevicesPageModule{}return AddonMessageOutputAirnotifierDevicesPageModule.ɵmod=l.wc({type:AddonMessageOutputAirnotifierDevicesPageModule}),AddonMessageOutputAirnotifierDevicesPageModule.ɵinj=l.vc({factory:function AddonMessageOutputAirnotifierDevicesPageModule_Factory(e){return new(e||AddonMessageOutputAirnotifierDevicesPageModule)},imports:[[n.m.forChild(A),o.a],n.m]}),AddonMessageOutputAirnotifierDevicesPageModule})();void(("undefined"==typeof ngJitMode||ngJitMode)&&l.kd(M,{declarations:[h],imports:[n.m,o.a],exports:[n.m]}))}}]);