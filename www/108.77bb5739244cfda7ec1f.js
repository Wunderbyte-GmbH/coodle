(window.webpackJsonp=window.webpackJsonp||[]).push([[108],{uFKL:function(e,n,t){"use strict";t.r(n),t.d(n,"CoreLoginSitePageModule",(function(){return B}));var i=t("tyNb"),o=t("L3Fv"),c=t("mrSG"),r=t("nvXB"),a=t("GGba"),l=t("BBqZ"),s=t("9+EE"),g=t("bFG1"),_=t("3LXp"),d=t("mv9v"),m=t("93ts"),u=t("BaYo"),h=t("j3ag"),p=t("oZnq"),f=t("mvS9"),C=t("JpIC"),P=t("m2Ry"),O=t("pHTc"),S=t("y9BN"),M=t("vuGA"),b=t("4reR"),v=t("X3v+"),L=t("51eS"),y=t("cjIW"),x=t("H8uD"),w=t("rdt7"),E=t("r2Z7"),T=t("fXoL"),I=t("3Pt+"),D=t("TEn/"),k=t("ACYt"),F=t("3CSS"),U=t("nt/U"),V=t("ofXK"),Q=t("6uVz"),q=t("sYmb");const R=["siteFormEl"];function CoreLoginSitePage_form_17_ng_container_2_Template(e,n){if(1&e&&(T.Cc(0),T.Ec(1,"ion-item"),T.Ec(2,"ion-label",15),T.Ec(3,"h2"),T.pd(4),T.Pc(5,"translate"),T.Dc(),T.Dc(),T.zc(6,"ion-input",16),T.Pc(7,"translate"),T.Dc(),T.Bc()),2&e){const e=T.Oc(2);T.lc(4),T.qd(T.Qc(5,3,"core.login.siteaddress")),T.lc(2),T.Wc("placeholder",T.Qc(7,5,"core.login.siteaddressplaceholder")),T.Vc("core-auto-focus",e.showKeyboard&&!e.showScanQR)}}function CoreLoginSitePage_form_17_ng_container_3_ion_item_14_Template(e,n){if(1&e){const e=T.Fc();T.Ec(0,"ion-item",27),T.Mc("click",(function CoreLoginSitePage_form_17_ng_container_3_ion_item_14_Template_ion_item_click_0_listener(n){T.fd(e);const t=T.Oc(3);return t.connect(n,t.enteredSiteUrl.url)})),T.Pc(1,"translate"),T.Ec(2,"ion-thumbnail",28),T.zc(3,"ion-icon",29),T.Dc(),T.Ec(4,"ion-label"),T.Ec(5,"h2",30),T.pd(6),T.Pc(7,"translate"),T.Dc(),T.Ec(8,"p"),T.pd(9),T.Dc(),T.Dc(),T.Dc()}if(2&e){const e=T.Oc(3);T.mc("aria-label",T.Qc(1,3,"core.login.connect")),T.lc(6),T.qd(T.Qc(7,5,"core.login.yourenteredsite")),T.lc(3),T.qd(e.enteredSiteUrl.noProtocolUrl)}}function CoreLoginSitePage_form_17_ng_container_3_div_16_Template(e,n){1&e&&(T.Ec(0,"div",31),T.zc(1,"ion-spinner"),T.Pc(2,"translate"),T.Dc()),2&e&&(T.lc(1),T.mc("aria-label",T.Qc(2,1,"core.loading")))}function CoreLoginSitePage_form_17_ng_container_3_ng_container_17_ng_container_1_Template(e,n){1&e&&T.Ac(0)}const _c1=function(e){return{site:e}};function CoreLoginSitePage_form_17_ng_container_3_ng_container_17_Template(e,n){if(1&e&&(T.Cc(0),T.nd(1,CoreLoginSitePage_form_17_ng_container_3_ng_container_17_ng_container_1_Template,1,0,"ng-container",32),T.Bc()),2&e){const e=n.$implicit;T.Oc(3);const t=T.ed(24);T.lc(1),T.Vc("ngTemplateOutlet",t)("ngTemplateOutletContext",T.ad(2,_c1,e))}}function CoreLoginSitePage_form_17_ng_container_3_div_18_Template(e,n){1&e&&(T.Ec(0,"div",33),T.zc(1,"ion-spinner"),T.Pc(2,"translate"),T.Dc()),2&e&&(T.lc(1),T.mc("aria-label",T.Qc(2,1,"core.loading")))}function CoreLoginSitePage_form_17_ng_container_3_Template(e,n){if(1&e){const e=T.Fc();T.Cc(0),T.Ec(1,"ion-item"),T.Ec(2,"ion-label",17),T.Ec(3,"h2"),T.pd(4),T.Pc(5,"translate"),T.Dc(),T.Dc(),T.Ec(6,"ion-input",18),T.Mc("ionChange",(function CoreLoginSitePage_form_17_ng_container_3_Template_ion_input_ionChange_6_listener(n){T.fd(e);const t=T.Oc(2);return t.searchSite(n,t.siteForm.value.siteUrl)})),T.Pc(7,"translate"),T.Dc(),T.Dc(),T.Ec(8,"ion-list",19),T.Ec(9,"ion-item",20),T.Ec(10,"ion-label"),T.Ec(11,"h2",21),T.pd(12),T.Pc(13,"translate"),T.Dc(),T.Dc(),T.Dc(),T.nd(14,CoreLoginSitePage_form_17_ng_container_3_ion_item_14_Template,10,7,"ion-item",22),T.Ec(15,"div",23),T.nd(16,CoreLoginSitePage_form_17_ng_container_3_div_16_Template,3,3,"div",24),T.nd(17,CoreLoginSitePage_form_17_ng_container_3_ng_container_17_Template,2,4,"ng-container",25),T.Dc(),T.Dc(),T.nd(18,CoreLoginSitePage_form_17_ng_container_3_div_18_Template,3,3,"div",26),T.Bc()}if(2&e){const e=T.Oc(2);T.lc(4),T.qd(T.Qc(5,14,"core.login.siteaddress")),T.lc(2),T.Wc("placeholder",T.Qc(7,16,"core.login.siteaddressplaceholder")),T.Vc("core-auto-focus",e.showKeyboard&&!e.showScanQR),T.lc(2),T.qc("hidden",!e.hasSites&&!e.enteredSiteUrl),T.lc(4),T.qd(T.Qc(13,18,"core.login.selectsite")),T.lc(2),T.Vc("ngIf",e.enteredSiteUrl),T.lc(1),T.qc("hidden",!e.hasSites)("dimmed",e.loadingSites),T.lc(1),T.Vc("ngIf",e.loadingSites),T.lc(1),T.Vc("ngForOf",e.sites),T.lc(1),T.Vc("ngIf",!e.hasSites&&e.loadingSites)}}function CoreLoginSitePage_form_17_ion_item_4_Template(e,n){if(1&e&&(T.Ec(0,"ion-item"),T.Ec(1,"ion-label"),T.Ec(2,"ion-button",34),T.pd(3),T.Pc(4,"translate"),T.Dc(),T.Dc(),T.Dc()),2&e){const e=T.Oc(2);T.lc(2),T.Vc("disabled",!e.siteForm.valid),T.lc(1),T.rd(" ",T.Qc(4,2,"core.login.connect")," ")}}function CoreLoginSitePage_form_17_Template(e,n){if(1&e){const e=T.Fc();T.Ec(0,"form",13,14),T.Mc("ngSubmit",(function CoreLoginSitePage_form_17_Template_form_ngSubmit_0_listener(n){T.fd(e);const t=T.Oc();return t.connect(n,t.siteForm.value.siteUrl)})),T.nd(2,CoreLoginSitePage_form_17_ng_container_2_Template,8,7,"ng-container",10),T.nd(3,CoreLoginSitePage_form_17_ng_container_3_Template,19,20,"ng-container",10),T.nd(4,CoreLoginSitePage_form_17_ion_item_4_Template,5,4,"ion-item",10),T.Dc()}if(2&e){const e=T.Oc();T.Vc("formGroup",e.siteForm),T.lc(2),T.Vc("ngIf","url"==e.siteSelector),T.lc(1),T.Vc("ngIf","url"!=e.siteSelector),T.lc(1),T.Vc("ngIf","url"==e.siteSelector)}}function CoreLoginSitePage_ng_container_18_ion_list_1_ion_searchbar_6_Template(e,n){if(1&e){const e=T.Fc();T.Ec(0,"ion-searchbar",36),T.Mc("ngModelChange",(function CoreLoginSitePage_ng_container_18_ion_list_1_ion_searchbar_6_Template_ion_searchbar_ngModelChange_0_listener(n){T.fd(e);return T.Oc(3).filter=n}))("ionInput",(function CoreLoginSitePage_ng_container_18_ion_list_1_ion_searchbar_6_Template_ion_searchbar_ionInput_0_listener(n){T.fd(e);return T.Oc(3).filterChanged(n)}))("ionCancel",(function CoreLoginSitePage_ng_container_18_ion_list_1_ion_searchbar_6_Template_ion_searchbar_ionCancel_0_listener(){T.fd(e);return T.Oc(3).filterChanged()})),T.Pc(1,"translate"),T.Dc()}if(2&e){const e=T.Oc(3);T.Vc("ngModel",e.filter)("placeholder",T.Qc(1,2,"core.login.findyoursite"))}}function CoreLoginSitePage_ng_container_18_ion_list_1_ng_container_7_ng_container_1_Template(e,n){1&e&&T.Ac(0)}function CoreLoginSitePage_ng_container_18_ion_list_1_ng_container_7_Template(e,n){if(1&e&&(T.Cc(0),T.nd(1,CoreLoginSitePage_ng_container_18_ion_list_1_ng_container_7_ng_container_1_Template,1,0,"ng-container",32),T.Bc()),2&e){const e=n.$implicit;T.Oc(3);const t=T.ed(24);T.lc(1),T.Vc("ngTemplateOutlet",t)("ngTemplateOutletContext",T.ad(2,_c1,e))}}function CoreLoginSitePage_ng_container_18_ion_list_1_Template(e,n){if(1&e&&(T.Ec(0,"ion-list"),T.Ec(1,"ion-item"),T.Ec(2,"ion-label"),T.Ec(3,"h2",21),T.pd(4),T.Pc(5,"translate"),T.Dc(),T.Dc(),T.Dc(),T.nd(6,CoreLoginSitePage_ng_container_18_ion_list_1_ion_searchbar_6_Template,2,4,"ion-searchbar",35),T.nd(7,CoreLoginSitePage_ng_container_18_ion_list_1_ng_container_7_Template,2,4,"ng-container",25),T.Dc()),2&e){const e=T.Oc(2);T.lc(4),T.qd(T.Qc(5,3,"core.login.selectsite")),T.lc(2),T.Vc("ngIf",e.fixedSites.length>4),T.lc(1),T.Vc("ngForOf",e.filteredSites)}}function CoreLoginSitePage_ng_container_18_Template(e,n){if(1&e&&(T.Cc(0),T.nd(1,CoreLoginSitePage_ng_container_18_ion_list_1_Template,8,5,"ion-list",10),T.Bc()),2&e){const e=T.Oc();T.lc(1),T.Vc("ngIf","list"==e.siteSelector)}}function CoreLoginSitePage_ng_container_19_Template(e,n){if(1&e){const e=T.Fc();T.Cc(0),T.Ec(1,"div",37),T.pd(2),T.Pc(3,"translate"),T.Dc(),T.Ec(4,"ion-button",38),T.Mc("click",(function CoreLoginSitePage_ng_container_19_Template_ion_button_click_4_listener(){T.fd(e);return T.Oc().showInstructionsAndScanQR()})),T.zc(5,"ion-icon",39),T.pd(6),T.Pc(7,"translate"),T.Dc(),T.Bc()}2&e&&(T.lc(2),T.qd(T.Qc(3,2,"core.login.or")),T.lc(4),T.rd(" ",T.Qc(7,4,"core.scanqr")," "))}function CoreLoginSitePage_ng_template_23_ion_thumbnail_1_img_1_Template(e,n){if(1&e&&T.zc(0,"img",45),2&e){const e=T.Oc(2).site;T.Vc("src",e.imageurl,T.id)}}function CoreLoginSitePage_ng_template_23_ion_thumbnail_1_img_2_Template(e,n){1&e&&T.zc(0,"img",46)}function CoreLoginSitePage_ng_template_23_ion_thumbnail_1_Template(e,n){if(1&e&&(T.Ec(0,"ion-thumbnail",0),T.nd(1,CoreLoginSitePage_ng_template_23_ion_thumbnail_1_img_1_Template,1,1,"img",43),T.nd(2,CoreLoginSitePage_ng_template_23_ion_thumbnail_1_img_2_Template,1,0,"img",44),T.Dc()),2&e){const e=T.Oc().site;T.lc(1),T.Vc("ngIf",e.imageurl),T.lc(1),T.Vc("ngIf",!e.imageurl)}}function CoreLoginSitePage_ng_template_23_p_3_Template(e,n){if(1&e&&(T.Ec(0,"p",47),T.pd(1),T.Dc()),2&e){const e=T.Oc().site;T.lc(1),T.qd(e.title)}}function CoreLoginSitePage_ng_template_23_p_4_Template(e,n){if(1&e&&(T.Ec(0,"p"),T.pd(1),T.Dc()),2&e){const e=T.Oc().site;T.lc(1),T.qd(e.noProtocolUrl)}}function CoreLoginSitePage_ng_template_23_p_5_Template(e,n){if(1&e&&(T.Ec(0,"p"),T.pd(1),T.Dc()),2&e){const e=T.Oc().site;T.lc(1),T.qd(e.location)}}function CoreLoginSitePage_ng_template_23_Template(e,n){if(1&e){const e=T.Fc();T.Ec(0,"ion-item",40),T.Mc("click",(function CoreLoginSitePage_ng_template_23_Template_ion_item_click_0_listener(t){T.fd(e);const i=n.site;return T.Oc().connect(t,i.url,i)})),T.nd(1,CoreLoginSitePage_ng_template_23_ion_thumbnail_1_Template,3,2,"ion-thumbnail",41),T.Ec(2,"ion-label"),T.nd(3,CoreLoginSitePage_ng_template_23_p_3_Template,2,1,"p",42),T.nd(4,CoreLoginSitePage_ng_template_23_p_4_Template,2,1,"p",10),T.nd(5,CoreLoginSitePage_ng_template_23_p_5_Template,2,1,"p",10),T.Dc(),T.Dc()}if(2&e){const e=n.site,t=T.Oc();T.mc("aria-label",e.name),T.lc(1),T.Vc("ngIf",t.siteFinderSettings.displayimage),T.lc(2),T.Vc("ngIf",e.title),T.lc(1),T.Vc("ngIf",e.noProtocolUrl),T.lc(1),T.Vc("ngIf",e.location)}}let j=(()=>{class CoreLoginSitePage{constructor(e){this.formBuilder=e,this.siteSelector="sitefinder",this.showKeyboard=!1,this.filter="",this.sites=[],this.hasSites=!1,this.loadingSites=!1;let n="";this.siteSelector=u.a.CONFIG.multisitesdisplay;this.siteFinderSettings=Object.assign({displaysitename:!0,displayimage:!0,displayalias:!0,displaycity:!0,displaycountry:!0,displayurl:!0},u.a.CONFIG.sitefindersettings||{}),d.a.hasSeveralFixedSites()?n=this.initSiteSelector():u.a.CONFIG.enableonboarding&&!E.a.isIOS()&&this.initOnboarding(),this.showScanQR=d.a.displayQRInSiteScreen(),this.siteForm=this.formBuilder.group({siteUrl:[n,this.moodleUrlValidator()]}),this.searchFunction=g.a.debounce((e=>Object(c.a)(this,void 0,void 0,(function*(){if((e=e.trim()).length>=3){const n=yield s.b.findSites(e);this.sites=this.extendCoreLoginSiteInfo(n),this.hasSites=!!this.sites.length}else this.hasSites=!1;this.loadingSites=!1}))),1e3)}ngOnInit(){this.showKeyboard=!!O.a.getRouteBooleanParam("showKeyboard")}initSiteSelector(){return this.fixedSites=this.extendCoreLoginSiteInfo(d.a.getFixedSites()),this.siteSelector="list",this.fixedSites.some((e=>!!e.imageurl))||(this.siteFinderSettings.displayimage=!1),this.filteredSites=this.fixedSites,this.fixedSites[0].url}initOnboarding(){return Object(c.a)(this,void 0,void 0,(function*(){(yield l.a.get(d.b.ONBOARDING_DONE,!1))||this.showOnboarding()}))}extendCoreLoginSiteInfo(e){return e.map((e=>{e.noProtocolUrl=this.siteFinderSettings.displayurl&&e.url?p.a.removeProtocol(e.url):"";const n=this.siteFinderSettings.displaysitename?e.name:"",t=this.siteFinderSettings.displayalias&&e.alias?e.alias:"";e.title=n&&t?n+" ("+t+")":n+t;const i=this.siteFinderSettings.displaycountry&&e.countrycode?g.a.getCountryName(e.countrycode):"",o=this.siteFinderSettings.displaycity&&e.city?e.city:"";return e.location=o&&i?o+" - "+i:o+i,s.b.hasDefaultImage(e)&&this.siteFinderSettings.defaultimageurl&&(e.imageurl=this.siteFinderSettings.defaultimageurl),e}))}moodleUrlValidator(){return e=>{const n=e.value.trim();let t=n.length>=3&&p.a.isValidMoodleUrl(n);if(!t){!!s.b.getDemoSiteData(n)&&(t=!0)}return t?null:{siteUrl:{value:e.value}}}}showHelp(){return Object(c.a)(this,void 0,void 0,(function*(){yield _.a.openModal({component:C.a,cssClass:"core-modal-fullscreen"})}))}showOnboarding(){return Object(c.a)(this,void 0,void 0,(function*(){yield _.a.openModal({component:P.a,cssClass:"core-modal-fullscreen"})}))}connect(e,n,t){return Object(c.a)(this,void 0,void 0,(function*(){if(e.preventDefault(),e.stopPropagation(),r.a.closeKeyboard(),!n)return _.a.showErrorModal("core.login.siteurlrequired",!0),void 0;if(!a.a.isOnline())return _.a.showErrorModal("core.networkerrormsg",!0),void 0;if((n=n.trim()).match(/^(https?:\/\/)?campus\.example\.edu/))return this.showLoginIssue(null,new m.a(h.I.instant("core.login.errorexampleurl"))),void 0;const i=s.b.getDemoSiteData(n);if(i)yield this.loginDemoSite(i);else{const e=yield _.a.showModalLoading();let i;try{i=yield s.b.checkSite(n)}catch(t){const o=p.a.guessMoodleDomain(n);if(!o||o==n)return e.dismiss(),this.showLoginIssue(n,t);try{i=yield s.b.checkSite(o)}catch(i){return e.dismiss(),this.showLoginIssue(n,t||i)}}yield this.login(i,t),e.dismiss()}}))}loginDemoSite(e){return Object(c.a)(this,void 0,void 0,(function*(){const n=yield _.a.showModalLoading();try{const t=yield s.b.getUserToken(e.url,e.username,e.password);return yield s.b.newSite(t.siteUrl,t.token,t.privateToken),b.a.triggerFormSubmittedEvent(this.formElement,!0),yield O.a.navigateToSiteHome(),void 0}catch(n){d.a.treatUserTokenError(e.url,n,e.username,e.password),n.loggedout&&O.a.navigate("/login/sites",{reset:!0})}finally{n.dismiss()}}))}login(e,n){var t;return Object(c.a)(this,void 0,void 0,(function*(){try{if(yield s.b.checkApplication(e.config),b.a.triggerFormSubmittedEvent(this.formElement,!0),d.a.isSSOLoginNeeded(e.code))d.a.confirmAndOpenBrowserForSSOLogin(e.siteUrl,e.code,e.service,null===(t=e.config)||void 0===t?void 0:t.launchurl);else{const t={siteUrl:e.siteUrl,siteConfig:e.config};n&&!this.fixedSites&&(t.siteName=n.name,t.logoUrl=n.imageurl),O.a.navigate("/login/credentials",{params:t})}}catch(e){}}))}showLoginIssue(e,n){return Object(c.a)(this,void 0,void 0,(function*(){let e,t,i,o,c=_.a.getErrorMessage(n),r=!1;n instanceof v.a&&(e=n.supportConfig,i=n.errorDetails,o=n.errorcode,r=e instanceof x.a),n instanceof w.a&&(t=n.title),i&&(c=`<p>${c}</p><div class="core-error-info-container"></div>`);const a=e,l=[{text:h.I.instant("core.tryagain"),role:"cancel"},(null==a?void 0:a.canContactSupport())?{text:h.I.instant("core.contactsupport"),handler:()=>L.a.contact({supportConfig:a,subject:h.I.instant("core.cannotconnect"),message:`Error: ${o}\n\n${i}`})}:r?null:{text:h.I.instant("core.needhelp"),cssClass:"core-login-need-help",handler:()=>this.showHelp()}].filter((e=>!!e)),s=yield _.a.showAlertWithOptions({header:null!=t?t:h.I.instant(r?"core.cannotconnect":"core.sitenotfound"),message:null!=c?c:h.I.instant("core.sitenotfoundhelp"),buttons:l});if(i){const e=s.querySelector(".core-error-info-container");e&&(e.innerHTML=y.a.render(i,o))}}))}filterChanged(e){var n;const t=null===(n=null==e?void 0:e.target.value)||void 0===n?void 0:n.trim().toLowerCase();this.filteredSites=t&&this.fixedSites?this.fixedSites.filter((e=>e.title.toLowerCase().indexOf(t)>-1||e.noProtocolUrl.toLowerCase().indexOf(t)>-1||e.location.toLowerCase().indexOf(t)>-1)):this.fixedSites}searchSite(e,n){this.loadingSites=!0,n=n.trim(),this.enteredSiteUrl=this.siteForm.valid&&n.length>=3?{url:n,name:"connect",title:"",location:"",noProtocolUrl:p.a.removeProtocol(n)}:void 0,this.searchFunction(n.trim())}showInstructionsAndScanQR(){return Object(c.a)(this,void 0,void 0,(function*(){try{yield d.a.showScanQRInstructions(),yield this.scanQR()}catch(e){}}))}scanQR(){return Object(c.a)(this,void 0,void 0,(function*(){const e=yield g.a.scanQR();if(!e)return;if(S.a.isCustomURL(e)){try{yield S.a.handleCustomURL(e)}catch(n){n&&n.data&&n.data.isAuthenticationURL&&n.data.siteUrl?this.treatErrorInAuthenticationCustomURL(e,n):S.a.treatHandleCustomURLError(n)}return}const n=f.a.getUrlProtocol(e);if(n&&"http"!=n&&"https"!=n)return _.a.showErrorModal(h.I.instant("core.errorurlschemeinvalidscheme",{$a:e})),void 0;(yield d.a.isSiteUrlAllowed(e))?(this.siteForm.controls.siteUrl.setValue(e),this.connect(new Event("click"),e)):_.a.showErrorModal("core.errorurlschemeinvalidsite",!0)}))}treatErrorInAuthenticationCustomURL(e,n){var t;return Object(c.a)(this,void 0,void 0,(function*(){const e=(null===(t=n.data)||void 0===t?void 0:t.siteUrl)||"",i=yield _.a.showModalLoading();this.siteForm.controls.siteUrl.setValue(e);try{const n=yield s.b.checkSite(e);yield s.b.checkApplication(n.config),d.a.isSSOLoginNeeded(n.code)||(yield O.a.navigate("/login/credentials",{params:{siteUrl:n.siteUrl,siteConfig:n.config}}))}catch(e){}finally{i.dismiss()}n.error=M.a.addTextToError(n.error,"<br><br>"+h.I.instant("core.login.youcanstillconnectwithcredentials")),S.a.treatHandleCustomURLError(n)}))}openSettings(){O.a.navigate("/settings")}}return CoreLoginSitePage.ɵfac=function CoreLoginSitePage_Factory(e){return new(e||CoreLoginSitePage)(T.yc(I.f))},CoreLoginSitePage.ɵcmp=T.sc({type:CoreLoginSitePage,selectors:[["page-core-login-site"]],viewQuery:function CoreLoginSitePage_Query(e,n){var t;(1&e&&T.ud(R,!0),2&e)&&(T.dd(t=T.Nc())&&(n.formElement=t.first))},decls:25,vars:17,consts:[["slot","start"],[3,"text"],["slot","end"],["fill","clear",3,"click"],["slot","icon-only","name","fas-cog","aria-hidden","true"],[1,"ion-padding"],[1,"list-item-limited-width"],[1,"ion-text-center","ion-padding","ion-margin-bottom","core-login-site-logo"],["src","assets/img/login_logo.png","role","presentation","alt","",1,"avatar-full","login-logo"],[3,"formGroup","ngSubmit",4,"ngIf"],[4,"ngIf"],["aria-haspopup","dialog","expand","block","fill","clear",1,"ion-margin-top","core-login-need-help","core-button-as-link","ion-text-wrap",3,"click"],["sitelisting",""],[3,"formGroup","ngSubmit"],["siteFormEl",""],["position"," stacked"],["name","url","type","url","formControlName","siteUrl",3,"placeholder","core-auto-focus"],["position","stacked"],["name","url","formControlName","siteUrl",3,"placeholder","core-auto-focus","ionChange"],[1,"core-login-site-list"],[1,"core-login-site-list-title"],[1,"item-heading"],["button","","detail","true","class","core-login-entered-site",3,"click",4,"ngIf"],[1,"core-login-site-list-found"],["class","core-login-site-list-loading",4,"ngIf"],[4,"ngFor","ngForOf"],["class","core-login-site-nolist-loading",4,"ngIf"],["button","","detail","true",1,"core-login-entered-site",3,"click"],["slot","start","aria-hidden","true"],["name","fas-pen","aria-hidden","true"],[1,"ion-text-wrap"],[1,"core-login-site-list-loading"],[4,"ngTemplateOutlet","ngTemplateOutletContext"],[1,"core-login-site-nolist-loading"],["expand","block","type","submit",1,"ion-text-wrap",3,"disabled"],[3,"ngModel","placeholder","ngModelChange","ionInput","ionCancel",4,"ngIf"],[3,"ngModel","placeholder","ngModelChange","ionInput","ionCancel"],[1,"ion-text-center","ion-padding","ion-margin-top","core-login-site-qrcode-separator"],["expand","block","fill","outline","aria-haspopup","dialog",1,"ion-margin","core-login-site-qrcode",3,"click"],["slot","start","name","fas-qrcode","aria-hidden","true"],["button","","detail","true",3,"click"],["slot","start",4,"ngIf"],["class","item-heading ion-text-wrap",4,"ngIf"],["onError","this.src='assets/icon/icon.png'","alt","","role","presentation",3,"src",4,"ngIf"],["src","assets/icon/icon.png","class","core-login-default-icon","alt","","role","presentation",4,"ngIf"],["onError","this.src='assets/icon/icon.png'","alt","","role","presentation",3,"src"],["src","assets/icon/icon.png","alt","","role","presentation",1,"core-login-default-icon"],[1,"item-heading","ion-text-wrap"]],template:function CoreLoginSitePage_Template(e,n){1&e&&(T.Ec(0,"ion-header"),T.Ec(1,"ion-toolbar"),T.Ec(2,"ion-buttons",0),T.zc(3,"ion-back-button",1),T.Pc(4,"translate"),T.Dc(),T.Ec(5,"ion-title"),T.Ec(6,"h1"),T.pd(7),T.Pc(8,"translate"),T.Dc(),T.Dc(),T.Ec(9,"ion-buttons",2),T.Ec(10,"ion-button",3),T.Mc("click",(function CoreLoginSitePage_Template_ion_button_click_10_listener(){return n.openSettings()})),T.Pc(11,"translate"),T.zc(12,"ion-icon",4),T.Dc(),T.Dc(),T.Dc(),T.Dc(),T.Ec(13,"ion-content",5),T.Ec(14,"div",6),T.Ec(15,"div",7),T.zc(16,"img",8),T.Dc(),T.nd(17,CoreLoginSitePage_form_17_Template,5,4,"form",9),T.nd(18,CoreLoginSitePage_ng_container_18_Template,2,1,"ng-container",10),T.nd(19,CoreLoginSitePage_ng_container_19_Template,8,6,"ng-container",10),T.Ec(20,"ion-button",11),T.Mc("click",(function CoreLoginSitePage_Template_ion_button_click_20_listener(){return n.showHelp()})),T.pd(21),T.Pc(22,"translate"),T.Dc(),T.Dc(),T.Dc(),T.nd(23,CoreLoginSitePage_ng_template_23_Template,6,5,"ng-template",null,12,T.od)),2&e&&(T.lc(3),T.Vc("text",T.Qc(4,9,"core.back")),T.lc(4),T.qd(T.Qc(8,11,"core.login.connecttomoodle")),T.lc(3),T.mc("aria-label",T.Qc(11,13,"core.settings.appsettings")),T.lc(5),T.qc("hidden",n.hasSites||n.enteredSiteUrl),T.lc(2),T.Vc("ngIf",!n.fixedSites),T.lc(1),T.Vc("ngIf",n.fixedSites),T.lc(1),T.Vc("ngIf",n.showScanQR&&!n.hasSites&&!n.enteredSiteUrl),T.lc(2),T.rd(" ",T.Qc(22,15,"core.needhelp")," "))},directives:[D.C,D.Ab,D.m,D.h,D.i,D.yb,k.a,D.l,D.D,F.a,U.a,D.v,V.t,I.H,I.s,I.k,D.I,D.O,D.H,D.Pb,I.r,I.i,Q.a,D.P,V.s,D.xb,D.qb,V.A,D.ib,I.u],pipes:[q.d],styles:["[_nghost-%COMP%]{--list-item-max-width:600px}.item-input[_ngcontent-%COMP%]:last-child{margin-bottom:20px}.core-login-site-connect[_ngcontent-%COMP%]{margin-top:1.4rem}.item[_ngcontent-%COMP%]   ion-thumbnail[_ngcontent-%COMP%]{min-width:50px;min-height:50px;width:50px;height:50px;border-radius:20%;box-shadow:0 0 4px var(--gray-200);text-align:center;overflow:hidden}.item[_ngcontent-%COMP%]   ion-thumbnail[_ngcontent-%COMP%]   img[_ngcontent-%COMP%]{max-height:50px;max-width:-webkit-fit-content;max-width:fit-content;width:auto;height:auto;margin:0 auto 0 50%;transform:translate3d(-50%,0,0);object-fit:cover;object-position:50% 50%}[dir=rtl][_nghost-%COMP%]   .item[_ngcontent-%COMP%]   ion-thumbnail[_ngcontent-%COMP%]   img[_ngcontent-%COMP%], [dir=rtl]   [_nghost-%COMP%]   .item[_ngcontent-%COMP%]   ion-thumbnail[_ngcontent-%COMP%]   img[_ngcontent-%COMP%], [dir=rtl][_ngcontent-%COMP%]   .item[_ngcontent-%COMP%]   ion-thumbnail[_ngcontent-%COMP%]   img[_ngcontent-%COMP%]{transform:translate3d(calc(-1 * -50%),0,0)}.item[_ngcontent-%COMP%]   ion-thumbnail[_ngcontent-%COMP%]   ion-icon[_ngcontent-%COMP%]{margin:0 auto;font-size:35px;height:50px}[dir=rtl][_nghost-%COMP%]   .item[_ngcontent-%COMP%]   ion-thumbnail[_ngcontent-%COMP%]   img[_ngcontent-%COMP%], [dir=rtl]   [_nghost-%COMP%]   .item[_ngcontent-%COMP%]   ion-thumbnail[_ngcontent-%COMP%]   img[_ngcontent-%COMP%]{margin-left:0;margin-right:50%}.core-login-site-list[_ngcontent-%COMP%], .core-login-site-list-found[_ngcontent-%COMP%], .core-login-site-logo[_ngcontent-%COMP%]{transition-delay:0s;visibility:visible;opacity:1;transition:all .7s ease-in-out;max-height:9999px}.core-login-site-list-found.hidden[_ngcontent-%COMP%], .core-login-site-list.hidden[_ngcontent-%COMP%], .core-login-site-logo.hidden[_ngcontent-%COMP%]{opacity:0;visibility:hidden;margin-top:0;margin-bottom:0;padding:0;max-height:0}.core-login-site-list-found.dimmed[_ngcontent-%COMP%]{pointer-events:none;position:relative}.core-login-site-list-loading[_ngcontent-%COMP%]{position:absolute;top:0;bottom:0;left:0;right:0;width:100%;height:100%;display:flex;align-content:center;align-items:center;background-color:hsla(0,0%,100%,.5);z-index:1}.core-login-site-list-loading[_ngcontent-%COMP%]   ion-spinner[_ngcontent-%COMP%]{margin:0 auto}.core-login-site-nolist-loading[_ngcontent-%COMP%]{margin-top:16px;text-align:center}.item.core-login-site-list-title[_ngcontent-%COMP%]   ion-label[_ngcontent-%COMP%], .item.core-login-site-list-title[_ngcontent-%COMP%]   ion-label[_ngcontent-%COMP%]   h2.item-heading[_ngcontent-%COMP%]{margin-top:0}@media (min-width:768px){ion-content[_ngcontent-%COMP%]   .core-login-site-logo[_ngcontent-%COMP%]{margin-top:20%}ion-content[_ngcontent-%COMP%]   .core-login-site-logo.hidden[_ngcontent-%COMP%]{margin-top:0}}.core-login-entered-site[_ngcontent-%COMP%]{background-color:var(--light)}.core-login-entered-site[_ngcontent-%COMP%]   ion-thumbnail[_ngcontent-%COMP%]{box-shadow:0 0 4px var(--gray-300)}.core-login-default-icon[_ngcontent-%COMP%]{filter:grayscale(100%)}","[_nghost-%COMP%]   ion-content[_ngcontent-%COMP%], [_nghost-%COMP%]   ion-list[_ngcontent-%COMP%]{--background:var(--core-login-background);--ion-item-background:var(--core-login-background)}[_nghost-%COMP%]   ion-content[_ngcontent-%COMP%], [_nghost-%COMP%]   ion-item[_ngcontent-%COMP%]   ion-label[_ngcontent-%COMP%], [_nghost-%COMP%]   ion-list[_ngcontent-%COMP%]{--color:var(--core-login-text-color)}[_nghost-%COMP%]   form[_ngcontent-%COMP%]   div[_ngcontent-%COMP%], [_nghost-%COMP%]   ion-item[_ngcontent-%COMP%]   ion-label[_ngcontent-%COMP%]   .core-oauth-icon[_ngcontent-%COMP%], [_nghost-%COMP%]   ion-item[_ngcontent-%COMP%]   ion-label[_ngcontent-%COMP%]   h2[_ngcontent-%COMP%], [_nghost-%COMP%]   ion-item[_ngcontent-%COMP%]   ion-label[_ngcontent-%COMP%]   h3[_ngcontent-%COMP%], [_nghost-%COMP%]   ion-item[_ngcontent-%COMP%]   ion-label[_ngcontent-%COMP%]   p[_ngcontent-%COMP%]{color:var(--color)}[_nghost-%COMP%]   ion-button.core-button-as-link[_ngcontent-%COMP%]{--color:var(--core-login-text-color);-webkit-text-decoration-color:var(--core-login-text-color);text-decoration-color:var(--core-login-text-color)}[_nghost-%COMP%]   ion-button.core-button-as-link[_ngcontent-%COMP%]   ion-label[_ngcontent-%COMP%]{color:var(--core-login-text-color)}[_nghost-%COMP%]   form[_ngcontent-%COMP%]   .core-username.item[_ngcontent-%COMP%], [_nghost-%COMP%]   form[_ngcontent-%COMP%]   .item.item-input[_ngcontent-%COMP%]{margin-bottom:16px}[_nghost-%COMP%]   form[_ngcontent-%COMP%]   .core-username.ios[_ngcontent-%COMP%]{--inner-border-width:0 0 1px 0}[_nghost-%COMP%]   form[_ngcontent-%COMP%]   .item[_ngcontent-%COMP%], [_nghost-%COMP%]   form[_ngcontent-%COMP%]   .item[_ngcontent-%COMP%]   ion-label[_ngcontent-%COMP%]{--background:var(--core-login-input-background);--color:var(--core-login-input-color)}[_nghost-%COMP%]   form[_ngcontent-%COMP%]   .core-username.item[_ngcontent-%COMP%]   p[_ngcontent-%COMP%]{font-size:16px}[_nghost-%COMP%]   form[_ngcontent-%COMP%]   .core-username.item.md[_ngcontent-%COMP%]   p[_ngcontent-%COMP%]{padding-left:8px}@supports ((-webkit-margin-start:0) or (margin-inline-start:0)) or (-webkit-margin-start:0){[_nghost-%COMP%]   form[_ngcontent-%COMP%]   .core-username.item.md[_ngcontent-%COMP%]   p[_ngcontent-%COMP%]{padding-left:unset;-webkit-padding-start:8px;padding-inline-start:8px}}[_nghost-%COMP%]   .core-login-site-logo[_ngcontent-%COMP%]   img[_ngcontent-%COMP%]{max-width:100%}[_nghost-%COMP%]   .core-sitename[_ngcontent-%COMP%] + .core-siteurl[_ngcontent-%COMP%]{margin-top:0}[_nghost-%COMP%]   .core-sitename[_ngcontent-%COMP%]{font-size:1.2rem;margin-bottom:0}[_nghost-%COMP%]   .core-login-site-logo[_ngcontent-%COMP%]{width:90%;max-width:300px;margin:5px auto}[_nghost-%COMP%]   .core-login-forgotten-password[_ngcontent-%COMP%]{text-decoration:underline}html.dark[_nghost-%COMP%]   core-loading[_ngcontent-%COMP%], html.dark   [_nghost-%COMP%]   core-loading[_ngcontent-%COMP%]{--loading-background:var(--core-login-background-dark);--loading-text-color:#fff;--loading-spinner:#fff}"]}),CoreLoginSitePage})();const A=[{path:"",component:j}];let B=(()=>{class CoreLoginSitePageModule{}return CoreLoginSitePageModule.ɵmod=T.wc({type:CoreLoginSitePageModule}),CoreLoginSitePageModule.ɵinj=T.vc({factory:function CoreLoginSitePageModule_Factory(e){return new(e||CoreLoginSitePageModule)},imports:[[i.m.forChild(A),o.a],i.m]}),CoreLoginSitePageModule})();void(("undefined"==typeof ngJitMode||ngJitMode)&&T.kd(B,{declarations:[j],imports:[i.m,o.a],exports:[i.m]}))}}]);