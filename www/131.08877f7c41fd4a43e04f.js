(window.webpackJsonp=window.webpackJsonp||[]).push([[131],{A7m2:function(e,t,i){"use strict";i.r(t),i.d(t,"CoreUserCourseLazyModule",(function(){return k}));var r=i("tyNb"),a=i("L3Fv"),c=i("PM4H"),n=i("mrSG"),s=i("nvXB"),o=i("3LXp"),_=i("pHTc"),l=i("EoRH"),p=i("46ml"),h=i("4pns"),u=i("bFG1"),d=i("xtzZ"),g=i("baaQ"),P=i("fXoL"),f=i("ACV2"),m=i("ACYt"),C=i("TEn/"),b=i("3CSS"),U=i("nt/U"),y=i("ofXK"),T=i("PgjG"),v=i("xpMl"),I=i("9zps"),O=i("r8G5"),x=i("FeAf"),E=i("hMzs"),M=i("sYmb"),w=i("lAaw");function CoreUserParticipantsPage_core_search_box_9_Template(e,t){if(1&e){const e=P.Fc();P.Ec(0,"core-search-box",11),P.Mc("onSubmit",(function CoreUserParticipantsPage_core_search_box_9_Template_core_search_box_onSubmit_0_listener(t){P.fd(e);return P.Oc().search(t)}))("onClear",(function CoreUserParticipantsPage_core_search_box_9_Template_core_search_box_onClear_0_listener(){P.fd(e);return P.Oc().clearSearch()})),P.Dc()}if(2&e){const e=P.Oc();P.Vc("disabled",e.searchInProgress)("spellcheck",!1)("autoFocus",!0)("lengthCheck",1)}}function CoreUserParticipantsPage_core_empty_box_11_Template(e,t){1&e&&(P.zc(0,"core-empty-box",12),P.Pc(1,"translate")),2&e&&P.Vc("message",P.Qc(1,1,"core.user.noparticipants"))}function CoreUserParticipantsPage_core_empty_box_12_Template(e,t){1&e&&(P.zc(0,"core-empty-box",13),P.Pc(1,"translate")),2&e&&P.Vc("message",P.Qc(1,1,"core.noresults"))}function CoreUserParticipantsPage_ion_list_13_ion_item_1_ng_container_3_p_3_ng_container_4_Template(e,t){if(1&e&&(P.Cc(0),P.pd(1),P.Pc(2,"coreTimeAgo"),P.Bc()),2&e){const e=P.Oc(3).$implicit;P.lc(1),P.rd("",P.Qc(2,1,e.lastcourseaccess)," ")}}function CoreUserParticipantsPage_ion_list_13_ion_item_1_ng_container_3_p_3_ng_container_5_Template(e,t){1&e&&(P.Cc(0),P.pd(1),P.Pc(2,"translate"),P.Bc()),2&e&&(P.lc(1),P.qd(P.Qc(2,1,"core.never")))}function CoreUserParticipantsPage_ion_list_13_ion_item_1_ng_container_3_p_3_Template(e,t){if(1&e&&(P.Ec(0,"p"),P.Ec(1,"strong"),P.pd(2),P.Pc(3,"translate"),P.Dc(),P.nd(4,CoreUserParticipantsPage_ion_list_13_ion_item_1_ng_container_3_p_3_ng_container_4_Template,3,3,"ng-container",9),P.nd(5,CoreUserParticipantsPage_ion_list_13_ion_item_1_ng_container_3_p_3_ng_container_5_Template,3,3,"ng-container",9),P.Dc()),2&e){const e=P.Oc(2).$implicit;P.lc(2),P.rd("",P.Qc(3,3,"core.user.lastcourseaccess"),": "),P.lc(2),P.Vc("ngIf",e.lastcourseaccess),P.lc(1),P.Vc("ngIf",!e.lastcourseaccess)}}function CoreUserParticipantsPage_ion_list_13_ion_item_1_ng_container_3_p_4_ng_container_4_Template(e,t){if(1&e&&(P.Cc(0),P.pd(1),P.Pc(2,"coreTimeAgo"),P.Bc()),2&e){const e=P.Oc(3).$implicit;P.lc(1),P.qd(P.Qc(2,1,e.lastaccess))}}function CoreUserParticipantsPage_ion_list_13_ion_item_1_ng_container_3_p_4_ng_container_5_Template(e,t){1&e&&(P.Cc(0),P.pd(1),P.Pc(2,"translate"),P.Bc()),2&e&&(P.lc(1),P.qd(P.Qc(2,1,"core.never")))}function CoreUserParticipantsPage_ion_list_13_ion_item_1_ng_container_3_p_4_Template(e,t){if(1&e&&(P.Ec(0,"p"),P.Ec(1,"strong"),P.pd(2),P.Pc(3,"translate"),P.Dc(),P.nd(4,CoreUserParticipantsPage_ion_list_13_ion_item_1_ng_container_3_p_4_ng_container_4_Template,3,3,"ng-container",9),P.nd(5,CoreUserParticipantsPage_ion_list_13_ion_item_1_ng_container_3_p_4_ng_container_5_Template,3,3,"ng-container",9),P.Dc()),2&e){const e=P.Oc(2).$implicit;P.lc(2),P.rd("",P.Qc(3,3,"core.lastaccess"),": "),P.lc(2),P.Vc("ngIf",e.lastaccess),P.lc(1),P.Vc("ngIf",!e.lastaccess)}}function CoreUserParticipantsPage_ion_list_13_ion_item_1_ng_container_3_Template(e,t){if(1&e&&(P.Cc(0),P.Ec(1,"p",17),P.pd(2),P.Dc(),P.nd(3,CoreUserParticipantsPage_ion_list_13_ion_item_1_ng_container_3_p_3_Template,6,5,"p",9),P.nd(4,CoreUserParticipantsPage_ion_list_13_ion_item_1_ng_container_3_p_4_Template,6,5,"p",9),P.Bc()),2&e){const e=P.Oc().$implicit;P.lc(2),P.qd(e.fullname),P.lc(1),P.Vc("ngIf",void 0!==e.lastcourseaccess),P.lc(1),P.Vc("ngIf",void 0===e.lastcourseaccess&&void 0!==e.lastaccess)}}function CoreUserParticipantsPage_ion_list_13_ion_item_1_ng_container_4_Template(e,t){if(1&e&&(P.Cc(0),P.Ec(1,"p",17),P.zc(2,"core-format-text",18),P.Dc(),P.Bc()),2&e){const e=P.Oc().$implicit,t=P.Oc(2);P.lc(2),P.Vc("text",e.fullname)("highlight",t.searchQuery)("filter",!1)}}function CoreUserParticipantsPage_ion_list_13_ion_item_1_Template(e,t){if(1&e){const e=P.Fc();P.Ec(0,"ion-item",15),P.Mc("click",(function CoreUserParticipantsPage_ion_list_13_ion_item_1_Template_ion_item_click_0_listener(){P.fd(e);const i=t.$implicit;return P.Oc(2).participants.select(i)})),P.zc(1,"core-user-avatar",16),P.Ec(2,"ion-label"),P.nd(3,CoreUserParticipantsPage_ion_list_13_ion_item_1_ng_container_3_Template,5,3,"ng-container",9),P.nd(4,CoreUserParticipantsPage_ion_list_13_ion_item_1_ng_container_4_Template,3,3,"ng-container",9),P.Dc(),P.Dc()}if(2&e){const e=t.$implicit,i=P.Oc(2);P.mc("aria-current",i.participants.getItemAriaCurrent(e))("aria-label",e.fullname),P.lc(1),P.Vc("user",e)("linkProfile",!1)("checkOnline",!0),P.lc(2),P.Vc("ngIf",!i.searchQuery),P.lc(1),P.Vc("ngIf",i.searchQuery)}}function CoreUserParticipantsPage_ion_list_13_Template(e,t){if(1&e&&(P.Ec(0,"ion-list"),P.nd(1,CoreUserParticipantsPage_ion_list_13_ion_item_1_Template,5,7,"ion-item",14),P.Dc()),2&e){const e=P.Oc();P.lc(1),P.Vc("ngForOf",e.participants.items)}}let V=(()=>{class CoreUserParticipantsPage{constructor(){this.searchQuery=null,this.searchInProgress=!1,this.searchEnabled=!1,this.showSearchBox=!1,this.fetchMoreParticipantsFailed=!1;try{this.courseId=_.a.getRequiredRouteNumberParam("courseId"),this.participants=new participants_page_CoreUserParticipantsManager(g.a.getOrCreateSource(d.a,[this.courseId]),CoreUserParticipantsPage)}catch(e){return o.a.showErrorModal(e),_.a.back(),void 0}}ngOnInit(){return Object(n.a)(this,void 0,void 0,(function*(){this.searchEnabled=yield h.a.canSearchParticipantsInSite()}))}ngAfterViewInit(){return Object(n.a)(this,void 0,void 0,(function*(){yield this.fetchInitialParticipants(),this.participants.start(this.splitView)}))}ngOnDestroy(){this.participants.destroy()}toggleSearch(){this.showSearchBox=!this.showSearchBox,this.showSearchBox?this.splitView.menuContent.scrollToTop():this.clearSearch()}clearSearch(){return Object(n.a)(this,void 0,void 0,(function*(){if(null===this.searchQuery)return;const e=g.a.getOrCreateSource(d.a,[this.courseId]);this.searchQuery=null,this.searchInProgress=!1,this.participants.setSource(e),yield this.fetchInitialParticipants()}))}search(e){return Object(n.a)(this,void 0,void 0,(function*(){s.a.closeKeyboard();const t=g.a.getOrCreateSource(d.a,[this.courseId,e]);this.searchInProgress=!0,this.searchQuery=e,this.participants.setSource(t),yield this.fetchInitialParticipants(),this.searchInProgress=!1}))}refreshParticipants(e){return Object(n.a)(this,void 0,void 0,(function*(){yield u.a.ignoreErrors(h.a.invalidateParticipantsList(this.courseId)),yield u.a.ignoreErrors(this.fetchParticipants(!0)),null==e||e.complete()}))}fetchMoreParticipants(e){return Object(n.a)(this,void 0,void 0,(function*(){try{yield this.fetchParticipants(!1)}catch(e){o.a.showErrorModalDefault(e,"Error loading more participants"),this.fetchMoreParticipantsFailed=!0}e()}))}fetchInitialParticipants(){return Object(n.a)(this,void 0,void 0,(function*(){try{yield this.fetchParticipants(!0)}catch(e){o.a.showErrorModalDefault(e,"Error loading participants"),this.participants.reset()}}))}fetchParticipants(e){return Object(n.a)(this,void 0,void 0,(function*(){e?yield this.participants.reload():yield this.participants.load(),this.fetchMoreParticipantsFailed=!1}))}}return CoreUserParticipantsPage.ɵfac=function CoreUserParticipantsPage_Factory(e){return new(e||CoreUserParticipantsPage)},CoreUserParticipantsPage.ɵcmp=P.sc({type:CoreUserParticipantsPage,selectors:[["page-core-user-participants"]],viewQuery:function CoreUserParticipantsPage_Query(e,t){var i;(1&e&&P.ud(p.a,!0),2&e)&&(P.dd(i=P.Nc())&&(t.splitView=i.first))},decls:15,vars:15,consts:[["slot","end"],[3,"hidden","click"],["name","fas-search","slot","icon-only","aria-hidden","true"],["slot","fixed",3,"disabled","ionRefresh"],[3,"pullingText"],["autocorrect","off","searchArea","CoreUserParticipants",3,"disabled","spellcheck","autoFocus","lengthCheck","onSubmit","onClear",4,"ngIf"],[3,"hideUntil"],["icon","far-user",3,"message",4,"ngIf"],["icon","fas-search",3,"message",4,"ngIf"],[4,"ngIf"],[3,"enabled","error","action"],["autocorrect","off","searchArea","CoreUserParticipants",3,"disabled","spellcheck","autoFocus","lengthCheck","onSubmit","onClear"],["icon","far-user",3,"message"],["icon","fas-search",3,"message"],["class","ion-text-wrap","button","","detail","true",3,"click",4,"ngFor","ngForOf"],["button","","detail","true",1,"ion-text-wrap",3,"click"],["slot","start",3,"user","linkProfile","checkOnline"],[1,"item-heading"],[3,"text","highlight","filter"]],template:function CoreUserParticipantsPage_Template(e,t){1&e&&(P.Ec(0,"core-navbar-buttons",0),P.Ec(1,"ion-button",1),P.Mc("click",(function CoreUserParticipantsPage_Template_ion_button_click_1_listener(){return t.toggleSearch()})),P.Pc(2,"translate"),P.zc(3,"ion-icon",2),P.Dc(),P.Dc(),P.Ec(4,"ion-content"),P.Ec(5,"core-split-view"),P.Ec(6,"ion-refresher",3),P.Mc("ionRefresh",(function CoreUserParticipantsPage_Template_ion_refresher_ionRefresh_6_listener(e){return t.refreshParticipants(e.target)})),P.zc(7,"ion-refresher-content",4),P.Pc(8,"translate"),P.Dc(),P.nd(9,CoreUserParticipantsPage_core_search_box_9_Template,1,4,"core-search-box",5),P.Ec(10,"core-loading",6),P.nd(11,CoreUserParticipantsPage_core_empty_box_11_Template,2,3,"core-empty-box",7),P.nd(12,CoreUserParticipantsPage_core_empty_box_12_Template,2,3,"core-empty-box",8),P.nd(13,CoreUserParticipantsPage_ion_list_13_Template,2,1,"ion-list",9),P.Ec(14,"core-infinite-loading",10),P.Mc("action",(function CoreUserParticipantsPage_Template_core_infinite_loading_action_14_listener(e){return t.fetchMoreParticipants(e)})),P.Dc(),P.Dc(),P.Dc(),P.Dc()),2&e&&(P.lc(1),P.Vc("hidden",!t.searchEnabled),P.mc("aria-label",P.Qc(2,11,"core.search")),P.lc(5),P.Vc("disabled",!t.participants.loaded||t.searchInProgress),P.lc(1),P.Wc("pullingText",P.Qc(8,13,"core.pulltorefresh")),P.lc(2),P.Vc("ngIf",t.showSearchBox),P.lc(1),P.Vc("hideUntil",t.participants.loaded),P.lc(1),P.Vc("ngIf",t.participants.empty&&!t.searchInProgress&&!t.searchQuery),P.lc(1),P.Vc("ngIf",t.participants.empty&&!t.searchInProgress&&t.searchQuery),P.lc(1),P.Vc("ngIf",!t.participants.empty),P.lc(1),P.Vc("enabled",t.participants.loaded&&!t.participants.completed)("error",t.fetchMoreParticipantsFailed))},directives:[f.a,m.a,C.l,C.D,b.a,U.a,C.v,p.a,C.bb,C.cb,y.t,T.a,v.a,I.a,O.a,C.P,y.s,C.I,x.a,C.O,E.a],pipes:[M.d,w.a],encapsulation:2}),CoreUserParticipantsPage})();class participants_page_CoreUserParticipantsManager extends l.a{logActivity(){return Object(n.a)(this,void 0,void 0,(function*(){yield h.a.logParticipantsView(this.getSource().COURSE_ID)}))}}var S=i("vY5A"),D=i("Y+03");const Q=[{path:"",component:V,children:Object(S.c)([{path:":userId",loadChildren:()=>i.e(12).then(i.bind(null,"RDa7")).then((e=>e.CoreUserProfilePageModule))}],(()=>D.a.isTablet))}];let k=(()=>{class CoreUserCourseLazyModule{}return CoreUserCourseLazyModule.ɵmod=P.wc({type:CoreUserCourseLazyModule}),CoreUserCourseLazyModule.ɵinj=P.vc({factory:function CoreUserCourseLazyModule_Factory(e){return new(e||CoreUserCourseLazyModule)},imports:[[r.m.forChild(Q),a.a,c.a]]}),CoreUserCourseLazyModule})();void(("undefined"==typeof ngJitMode||ngJitMode)&&P.kd(k,{declarations:[V],imports:[r.m,a.a,c.a]}))}}]);